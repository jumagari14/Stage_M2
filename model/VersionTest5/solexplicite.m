function [ p ] = solexplicite( parK,t )
% solution exacte de dp/dt=ks*R-kd*p
% quand R est un polynome de degré 3
% R(t)=b3*(t-tm)^3/sig^3+b2*(t-tm)^2/sig^2+b1*(t-tm)/sig+b0
% ptrans3=[b3,b2,b1,b0] mt3=[tm,sig]

global ptrans3  mt3

b3=ptrans3(1);b2=ptrans3(2);b1=ptrans3(3);b0=ptrans3(4);
tm=mt3(1);sig=mt3(2);
ks=parK(2);kd=parK(3);p1=parK(1);t1=t(1);
%   Detailed explanation goes here

%p2=(-kd^2*b1*sig^2+2*kd^2*b2*tm*sig-3*kd^2*tm^2*b3-kd^3*b1*sig^2*tm+kd^3*b2*sig*tm^2 ...
%-kd^3*b3*tm^3+kd^3*b0*sig^3+2*kd*b2*sig-6*kd*tm*b3-6*b3+kd^3*t.*b1*sig^2-2*kd^3*t.*b2*tm*sig...
%+3*kd^3*t.*tm^2*b3-2*kd^2*t.*b2*sig+6*kd^2*t.*tm*b3+6*kd*t.*b3+t.^2*kd^3*b2*sig-3*t.^2*kd^3*tm*b3...
%-3*t.^2*kd^2*b3+b3*t.^3*kd^3).*ks/(kd^4*sig^3)...
%-(-p1*kd^4*sig^3-ks*kd^2*b1*sig^2 ...
%+2*ks*kd^2*b2*tm*sig-3*ks*kd^2*tm^2*b3...
%-ks*kd^3*b1*sig^2*tm+ks*kd^3*b2*sig*tm^2 ...
%-ks*kd^3*b3*tm^3+ks*kd^3*b0*sig^3 ...
%+2*ks*kd*b2*sig-6*ks*kd*tm*b3-...
%    6*ks*b3+ks*kd^3*t1*b1*sig^2 ...
%    -2*ks*kd^3*t1*b2*tm*sig+3*ks*kd^3*t1*tm^2*b3...
%    -2*ks*kd^2*t1*b2*sig+6*ks*kd^2*t1*tm*b3...
%    +6*ks*kd*t1*b3+ks*t1^2*kd^3*b2*sig...
%    -3*ks*t1^2*kd^3*tm*b3-3*ks*t1^2*kd^2*b3...
%    +ks*b3*t1^3*kd^3)/(kd^4*sig^3).*exp(-kd*(t-t1))

p=(-kd^2*b1*sig^2+2*kd^2*tm*sig*b2-3*kd^2*b3*tm^2-kd^3*b1*sig^2*tm+kd^3*b2*sig*tm^2 ...
    -kd^3*b3*tm^3+kd^3*b0*sig^3+2*kd*b2*sig-6*kd*b3*tm-6*b3+kd^3*t.*b1*sig^2 ...
    -2*kd^3*t.*tm*sig*b2+3*kd^3*t.*b3*tm^2-2*kd^2*t.*b2*sig+6*kd^2*t.*b3*tm ...
    +6*kd*t.*b3+t.^2*kd^3*b2*sig-3*t.^2*kd^3*b3*tm-3*t.^2*kd^2*b3+b3*t.^3*kd^3).*ks/(kd^4*sig^3)...
    -exp(-kd*(t-t1))./(kd^4*sig^3)*...
    (-p1*kd^4*sig^3-ks*kd^2*b1*sig^2+2*ks*kd^2*tm*sig*b2...
    -3*ks*kd^2*b3*tm^2-ks*kd^3*b1*sig^2*tm...
    +ks*kd^3*b2*sig*tm^2 ...
    -ks*kd^3*b3*tm^3+ks*kd^3*b0*sig^3+2*ks*kd*b2*sig-6*ks*kd*b3*tm-6*ks*b3+ks*kd^3*t1*b1*sig^2 ...
-2*ks*kd^3*t1*tm*sig*b2+3*ks*kd^3*t1*b3*tm^2-2*ks*kd^2*t1*b2*sig+6*ks*kd^2*t1*b3*tm+6*ks*kd*t1*b3 ...   
+ks*t1^2*kd^3*b2*sig-3*ks*t1^2* kd^3* b3*tm-3*ks*t1^2*kd^2*b3+ks*b3*t1^3*kd^3);

end

