setwd("E:/Stage M2/Analyse_stats")


tpm<-read.csv("TPM.csv")

spikes<-tpm[grepl("*spike*",tpm$Gene),]
data<-tpm[!grepl("*spike*",tpm$Gene),]


spike_mol<-vector(mode = "list",length = 4)
names(spike_mol)<-c("M8","M5","M6","M7")
spike_mol[[1]]<-c(c(2.574E-5,1.901E-4,1.259E-3,1.043E-2,9.931E-2,8.108E-1,5.132,37.44),c(9.975e-06, 7.304e-05, 0.0004923999999999999, 0.004072, 0.03801, 0.3144, 1.99, 14.540000000000001),c(1.022e-05, 7.508e-05, 0.0005027, 0.0041600000000000005, 0.03937, 0.3221, 2.04, 14.89))
spike_mol[[2]]<-c(c(5.148e-05, 0.0003802, 0.002518, 0.02086, 73.46, 0.08108, 0.687, 3.7809999999999997),c(1.995e-05, 0.0001461, 0.0009847999999999999, 0.008144, 28.12, 0.031439999999999996, 0.2664, 1.468),c(7.661e-06, 7.633e-05, 0.0008072, 0.008157999999999999, 29.12, 0.032209999999999996, 0.2731, 1.503))
spike_mol[[3]]<-c(c(5.148e-05, 0.0003802, 0.002518, 0.02086, 0.1986, 59.98, 0.5061, 5.132),c(1.995e-05, 0.0001461, 0.0009847999999999999, 0.008144, 0.07601000000000001, 23.26, 0.19649999999999998, 1.99),c(7.661e-06, 7.633e-05, 0.0008072, 0.008157999999999999, 0.08030000000000001, 23.830000000000002, 0.2012, 2.04))
spike_mol[[4]]<-c(c(2.574e-05, 0.0001901, 0.001259, 0.01043, 0.09931000000000001, 0.8108, 50.82, 3.7809999999999997),c(9.975e-06, 7.304e-05, 0.0004923999999999999, 0.004072, 0.03801, 0.3144, 19.709999999999997, 1.468),c(3.831e-06, 3.816e-05, 0.0004036, 0.004078999999999999, 0.040150000000000005, 0.4012, 39.71, 4.013))

ex_dataf<-data.frame("mol"=spike_mol[[1]][1:8],"tpm"=spikes$X5012)
model<-lm(mol~tpm,ex_dataf)

prediction<-predict(model,data.frame("tpm"=data$X5012))
